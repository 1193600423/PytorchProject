# PytorchProject

### 运行结果

```angular2html
Read Data Ready!
Data Set Ready!
Data Loader Ready!
Using cuda device
Epoch 1
-------------------------------
loss: 0.694951  [  256/25000]
Test Error: 
 Accuracy: 50.0%, Avg loss: 0.692786 

Epoch 2
-------------------------------
loss: 0.693148  [  256/25000]
Test Error: 
 Accuracy: 50.0%, Avg loss: 0.693022 

Epoch 3
-------------------------------
loss: 0.692636  [  256/25000]
Test Error: 
 Accuracy: 50.0%, Avg loss: 0.693015 

Epoch 4
-------------------------------
loss: 0.693011  [  256/25000]
Test Error: 
 Accuracy: 50.0%, Avg loss: 0.692629 

Epoch 5
-------------------------------
loss: 0.692445  [  256/25000]
Test Error: 
 Accuracy: 50.0%, Avg loss: 0.692811 
```

### 问题描述

在训练函数train(dataloader, model, loss_fn, optimizer)，在 line133```pred = model(X) ```处断点，发现

- pred 结果是

```
tensor([[0.4921],
        [0.4921],
        [0.4921],
        [0.4921],
        ...
        [0.4921],
        [0.4921],
        [0.4921]], device='cuda:0', grad_fn=<SigmoidBackward0>)
```

- 而 X 的 shape 是 {256, 574, 128} （574 是文本的单词数）
- X 数值是

```
tensor([[[-2.7485e-01, -3.1219e-01,  1.7378e-01,  ..., -1.9129e-01,
          -1.9448e-02, -7.3364e-01],
         [ 1.8397e+00, -9.5353e-01,  1.1578e+00,  ..., -1.2141e+00,
          -7.7015e-02, -7.1773e-01],
         [ 9.3472e-02,  3.3357e-02,  4.2677e-01,  ..., -7.7607e-01,
           5.1676e-02, -9.6631e-01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 1.8397e+00, -9.5353e-01,  1.1578e+00,  ..., -1.2141e+00,
          -7.7015e-02, -7.1773e-01],
         [ 1.6330e-01, -4.3881e-01, -2.6064e-01,  ...,  3.6884e-02,
          -5.4436e-02,  6.8749e-01],
         [-1.3967e-01, -4.6770e-01,  1.4028e-01,  ...,  5.5282e-02,
          -2.4515e-01,  6.5220e-01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[-5.1402e-01, -6.5197e-01,  1.0857e+00,  ..., -1.2707e+00,
          -7.0802e-01, -2.0294e+00],
         [-2.8239e-01, -3.7811e-01,  6.1864e-01,  ..., -5.8056e-02,
          -1.5839e-01, -8.0434e-01],
         [ 1.8646e-01, -6.2750e-01, -4.4808e-01,  ..., -6.4518e-01,
           1.7246e-02,  5.1633e-01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        ...,

        [[-1.5027e-01, -1.4023e-01,  2.2799e+00,  ...,  6.1492e-01,
          -2.1308e+00, -1.7333e-01],
         [ 1.9153e-05, -4.7493e-02,  3.3964e-02,  ...,  2.1357e-02,
          -8.0132e-02,  4.0501e-02],
         [-1.7539e-01, -6.3494e-01,  7.7016e-01,  ..., -1.0771e+00,
          -1.5978e+00,  4.3089e-02],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[-8.5012e-01, -4.8866e-01,  9.0554e-01,  ...,  4.2474e-01,
           3.1898e-02,  3.7528e-02],
         [ 4.6046e-01,  4.8616e-01,  3.1695e-01,  ..., -2.4840e-01,
          -5.3027e-01,  7.9458e-01],
         [ 5.1419e-01,  4.5668e-01,  6.5484e-01,  ..., -4.0616e-01,
          -3.4784e-01,  5.9692e-01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 1.5022e+00, -1.6733e+00, -1.5340e-01,  ...,  2.5170e-01,
          -6.6799e-01, -1.1271e+00],
         [-1.4915e-01, -1.6670e+00,  3.1562e-01,  ...,  6.9830e-01,
           4.9208e-01, -1.2170e+00],
         [-6.0340e-01, -3.4942e-01,  7.0658e-01,  ..., -1.4850e+00,
           7.7830e-01,  3.3238e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]]], device='cuda:0')
```